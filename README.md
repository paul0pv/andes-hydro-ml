# Estimation of Surface Hydric Status in High-Andean Wetlands (Physics-Aware ML)

[![Python 3.8+](https://img.shields.io/badge/python-3.8+-blue.svg)](https://www.python.org/downloads/release/python-380/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](LICENSE)
[![Binder](https://mybinder.org/badge_logo.svg)](https://mybinder.org/v2/gh/paul0pv/andes-hydro-ml/main?filepath=notebooks%2Fmain_analysis.ipynb)
[![Status](https://img.shields.io/badge/Status-Educational_Research-green)]()

This repository contains the source code, dataset generation scripts, and methodology for the academic research project:

> **"Estimation of Surface Hydric Status in High-Andean Wetlands via Radar-Optical Sensor Fusion and Physics-Aware Machine Learning"**

## üìå Project Overview

High-Andean wetlands (*bofedales*) are critical for water security in the Altiplano but lack sufficient in-situ monitoring networks. This project implements a **Physics-Aware Machine Learning** framework to estimate Surface Hydric Status (SHS) by fusing multi-source satellite data.

The core methodology uses a **Stacking Ensemble** architecture to perform implicit statistical downscaling, transferring ERA5-Land's temporal dynamics (climate) to the fine spatial resolution of Sentinel sensors (10 m).

### Key Features
* **Multi-Sensor Fusion:** Integration of **Sentinel-1** (SAR Backscatter $\sigma^0$), **Sentinel-2** (Optical Indices), and **ERA5-Land** (Climatology).
* **Physics-Aware Feature Engineering:** Incorporation of hydrological memory via the *Antecedent Precipitation Index (API)* to constrain ML predictions during cloud cover or sensor saturation.
* **Spatial Block Validation:** Robust train/test splitting using geographic blocks (North vs. South) to prevent spatial autocorrelation leakage.
* **Domain Adaptation:** A Transfer Learning protocol to scale the model from calibrated basins (Ramis) to uncalibrated basins (Ilave) with minimal data points.

---

## üìÇ Repository Structure

```text
‚îú‚îÄ‚îÄ data/                  # Input CSV files (must be generated via GEE script)
‚îú‚îÄ‚îÄ notebooks/             # Jupyter Notebooks
‚îÇ   ‚îî‚îÄ‚îÄ main_analysis.ipynb  # MASTER NOTEBOOK: Preprocessing, Modeling & Validation
‚îú‚îÄ‚îÄ scripts/               # Google Earth Engine (GEE) scripts
‚îÇ   ‚îî‚îÄ‚îÄ gee-data.js        # JavaScript code for mass data export (S1, S2, ERA5)
‚îú‚îÄ‚îÄ figures/               # Output figures generated by the analysis
‚îú‚îÄ‚îÄ requirements.txt       # Python dependencies
‚îú‚îÄ‚îÄ LICENSE                # MIT License
‚îî‚îÄ‚îÄ README.md              # Project documentation
```

---

## üöÄ Getting Started
### 1. Prerequisites
The code is designed to run in Google Colab or a local Python environment (requires Python 3.8+).

Install dependencies:

```Bash
pip install -r requirements.txt
```

### 2. Data Acquisition (Google Earth Engine)
Before running the Python notebook, data must be exported from GEE.

1. Open the script located in `scripts/gee_export.js` in the GEE Code Editor.

2. Run the script. This will generate tasks in the "Tasks" tab..

3. Run all tasks to export the CSV files to your Google Drive folder (default: `GEE_Hydro_Dataset`).

4. Download these files and place them in the `data/` folder of this repository.

### 3. Running the Analysis
1. Open `notebooks/main_analysis.ipynb`.

2. Ensure the BASE_PATH variable points to your local `data/` directory..

3. Run all cells sequentially.

> **Note on Reproducibility:** A global random seed (`RANDOM_STATE = 42`) is set to ensure consistent results in splitting and model initialization.

---

## üìä Methodology & Results Summary
### Model Architecture
The system employs a 2-Level Stacking Ensemble:

- **Level 0 (Base Learners):** Random Forest, XGBoost, LightGBM (capturing non-linear integrations).

- **Level 1 (Meta-Learner):** Ridge Regression (providing bias correction and regularization).

### Performance Metrics (Ramis Basis - Test Set)

|Metric|Value|Unit|Description|
|---|---|---|---|
|KGE|0.88|-|Kling-Gupta Efficiency (Hydrological standard)|
|R2|0.85|-|Coefficient of Determination|
|ubRMSE|0.038|m3/m3|Unbiased Root Mean Square Error|
|Bias|-0.019|m3/m3|Systematic Error|

---

## üìú Citation
If you use this code or methodology for academic purposes, please cite the associated work:

```
@article{Ayma2025,
  title={Estimation of Surface Hydric Status in High-Andean Wetlands via Radar-Optical Sensor Fusion},
  author={Ayma, F. and Chapo√±√°n, Z. and Panduro, P. and Pardo, A. and Perez, A. and Sandoval, J.},
  journal={},
  year={2025}
}
```

---

## üë• Authors & Contact
- F. Ayma

- Z. Chapo√±√°n (zavy.chaponan@unmsm.edu.pe)

- P. Panduro
 
- A. Pardo
 
- A. Perez
 
- J. Sandoval

Project developed for the Microwave Engineering course.

---

## ‚öñÔ∏è License
This project is licensed under the MIT License - see the LICENSE file for details.

